
<h4 class="card-title mb-4 mt-1">マイページ</h4>
<div class="card">
  <article class="card-body">
    <div class="row">
      <div class="col-md-3">
        <%= image_tag @user.icon.url, size: '200x200' if @user.icon.present? %>
        <p class="text-center"><%= @user.name %></p>
      </div>
      <div class="col-md-9">
        <%= simple_format(@user.profile) %>
      </div> 
    </div>
    <% if current_user.id == @user.id%>
      <%= link_to '編集', edit_user_registration_path, class:"btn-sm btn-dark"%> 
    <% end %>
  </article>
</div>

<% if current_user.id == @user.id%>
  <%= link_to '本を登録する', publications_path, class:"btn-sm btn-dark"%>
  <%= form_with(url: user_path(current_user.id), method: 'get', local: true)do |f| %>
    <%= f.label "タイトル" %>:<%= f.text_field :title , value: params[:title] %>
    <%= f.label "著者" %>:<%= f.text_field :author , value: params[:author] %>
    <%= f.label "カテゴリー" %>:<%= f.text_field :category_name , value: params[:category_name] %>
    <%= f.submit "検索" ,class:"btn-sm"%>
    <%= link_to 'クリア', user_path(current_user.id) ,class:"btn-sm btn-dark"%>
  <% end %>

  <%= paginate @books %>
  <div class="row">
    <% @books.each do |book| %>
      <div class="col-md-4 mx-auto">
        <div class="book_container mb-2 ">
          <div class="row">
            <div class='col-md-9'>
              <%= book.publication.title %><br>
              <%= book.publication.author %><br>
            </div>
            <div class='col-md-3'>
              <%= link_to '編集', edit_book_path(book.id)%>
              <%= link_to '削除', book_path(book.id), method: :delete, data:{ confirm: "#{book.publication.title}を削除しますがよろしいですか？"}%>
            </div>
          </div>
          <%= render 'books/category_list', category_list: book.category_list %><br>
          <div class='text-center'>
            <%= image_tag(book.publication.image , size: '200x200')%>
          </div>
        </div>
      </div>
    <% end %>
  </div>
<% end %>